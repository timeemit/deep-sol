<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sol Glyph</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
		<h1 class="text-3xl text-center">Sol Glyph</h1>
    <div class="flex flex-row flex-wrap text-center">
      <div class="basis-1/5">
        <canvas id="left" class="mx-auto w-16 h-16"></canvas>
      </div>
      <div class="basis-1/5">
        <canvas id="center-left" class="mx-auto w-16 h-16"></canvas>
      </div>
      <div class="basis-1/5">
        <canvas id="center" class="mx-auto w-16 h-16"></canvas>
      </div>
      <div class="basis-1/5">
        <canvas id="center-right" class="mx-auto w-16 h-16"></canvas>
      </div>
      <div class="basis-1/5">
        <canvas id="right" class="mx-auto w-16 h-16"></canvas>
      </div>
      <div class="basis-1/5">A Randomly Generated Image (A)</div>
      <div class="basis-3/5">Images "Between" A &amp; B</div>
      <div class="basis-1/5">A Randomly Generated Image (B)</div>
    </div>
    <h2 class="text-xl text-center">You're Looking at Images Generated<br />Entirely on the Solana Blockchain<br />Using Machine Learning</h2>
    <script>
      // Standard Normal variate using Box-Muller transform.
      function randn() {
        var u = 0, v = 0;
        while(u === 0) u = Math.random(); //Converting [0,1) to (0,1)
        while(v === 0) v = Math.random();
        return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );
      }

      function randArray(size) {
        return Array(size).fill(0).map(randn);
      }

      function drawImage(target, values) {
        jQuery.ajax({
          url: "/img",
          type: "POST",
          data: JSON.stringify({ values: values }),
          contentType: "application/json",
          dataType: "json",
          success: function (data) {
            var canvas = document.getElementById(target);
            var ctx = canvas.getContext('2d');

            // get current raster data
            var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            var data = imageData.data;

            // prepare data
            for(var i = 0; i < data.length; i++) {
              data[i] = Math.random() * 255;
            }

            // draw newly modified pixels back onto the canvas
            ctx.putImageData(imageData, 0, 0);
          },
        });
      }

      function drawImages() {
        drawImage("left", randArray(10));
        drawImage("right", randArray(10));
      }

      $.when($.ready).then(drawImages);
    </script>
  </body>
</html>
